{"version":3,"file":"describe_tier.js","names":["_defaultTo","_interopRequireDefault","require","_keyBy","_add_quotes","_describe_is_item","_describe_is_any_value","_join_or","_describe_user_attribute","_escape_parameter_value","obj","__esModule","describeMultiValue","values","field","parameter","has_allowed_values","valueMap","keyBy","enumerations","joinOr","map","value","_valueMap$escapedValu","escapedValue","escapeParameterValue","label","addQuotes","match","_ref","_","is","length","describeIsItem","describeIsAnyValue","filterToStringMap","user_attribute","describeUserAttribute","anyvalue","describeTier","item","filterType","defaultTo","type","exports"],"sources":["../../../../src/utils/tier/describe_tier.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\nimport type { ILookmlModelExploreField } from '@looker/sdk'\nimport defaultTo from 'lodash/defaultTo'\nimport keyBy from 'lodash/keyBy'\nimport type { FilterItemToStringMapType, FilterModel } from '../..'\nimport type { FilterExpressionType } from '../../types'\nimport { addQuotes } from '../string/add_quotes'\nimport { describeIsItem } from '../summary/describe_is_item'\nimport { describeIsAnyValue } from '../summary/describe_is_any_value'\nimport { joinOr } from '../summary/join_or'\nimport { describeUserAttribute } from '../user_attribute/describe_user_attribute'\nimport { escapeParameterValue } from './escape_parameter_value'\n\nconst describeMultiValue = (\n  values: string[],\n  field?: ILookmlModelExploreField | null\n) => {\n  if (values) {\n    if (field?.parameter && field?.has_allowed_values) {\n      // if it's a parameter field - lookup value in enumerations to get label\n      const valueMap = keyBy(field.enumerations, 'value')\n      return joinOr(\n        values.map((value) => {\n          // parameter values in enumeration are already escaped\n          // we escape here to match the enumeration values\n          const escapedValue = escapeParameterValue(value)\n          // if value is found in the enumeration list we return the label,\n          // otherwise we will use the value as label\n          return valueMap[escapedValue]?.label || value\n        })\n      )\n    }\n    return joinOr(values.map(addQuotes))\n  }\n  return ''\n}\n\nconst match = (\n  { is, value }: FilterModel,\n  _?: string,\n  field?: ILookmlModelExploreField | null\n) => {\n  return value && value.length\n    ? describeIsItem(is, describeMultiValue(value, field))\n    : describeIsAnyValue()\n}\n\nconst filterToStringMap: FilterItemToStringMapType = {\n  match,\n  user_attribute: describeUserAttribute,\n  anyvalue: describeIsAnyValue,\n}\n\n/**\n * Maps a FilterItem to a function for converting it to a filter summary\n */\nexport const describeTier = (\n  item: FilterModel,\n  filterType?: FilterExpressionType,\n  field?: ILookmlModelExploreField | null\n): string =>\n  defaultTo(filterToStringMap[item.type], () => '')(item, filterType, field)\n"],"mappings":";;;;;;AAKA,IAAAA,UAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,MAAA,GAAAF,sBAAA,CAAAC,OAAA;AAGA,IAAAE,WAAA,GAAAF,OAAA;AACA,IAAAG,iBAAA,GAAAH,OAAA;AACA,IAAAI,sBAAA,GAAAJ,OAAA;AACA,IAAAK,QAAA,GAAAL,OAAA;AACA,IAAAM,wBAAA,GAAAN,OAAA;AACA,IAAAO,uBAAA,GAAAP,OAAA;AAA+D,SAAAD,uBAAAS,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,gBAAAA,GAAA;AAE/D,IAAME,kBAAkB,GAAG,SAArBA,kBAAkBA,CACtBC,MAAgB,EAChBC,KAAuC,EACpC;EACH,IAAID,MAAM,EAAE;IACV,IAAIC,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEC,SAAS,IAAID,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEE,kBAAkB,EAAE;MAEjD,IAAMC,QAAQ,GAAG,IAAAC,iBAAK,EAACJ,KAAK,CAACK,YAAY,EAAE,OAAO,CAAC;MACnD,OAAO,IAAAC,eAAM,EACXP,MAAM,CAACQ,GAAG,CAAC,UAACC,KAAK,EAAK;QAAA,IAAAC,qBAAA;QAGpB,IAAMC,YAAY,GAAG,IAAAC,4CAAoB,EAACH,KAAK,CAAC;QAGhD,OAAO,EAAAC,qBAAA,GAAAN,QAAQ,CAACO,YAAY,CAAC,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwBG,KAAK,KAAIJ,KAAK;MAC/C,CAAC,CACH,CAAC;IACH;IACA,OAAO,IAAAF,eAAM,EAACP,MAAM,CAACQ,GAAG,CAACM,qBAAS,CAAC,CAAC;EACtC;EACA,OAAO,EAAE;AACX,CAAC;AAED,IAAMC,KAAK,GAAG,SAARA,KAAKA,CAAAC,IAAA,EAETC,CAAU,EACVhB,KAAuC,EACpC;EAAA,IAHDiB,EAAE,GAAAF,IAAA,CAAFE,EAAE;IAAET,KAAK,GAAAO,IAAA,CAALP,KAAK;EAIX,OAAOA,KAAK,IAAIA,KAAK,CAACU,MAAM,GACxB,IAAAC,gCAAc,EAACF,EAAE,EAAEnB,kBAAkB,CAACU,KAAK,EAAER,KAAK,CAAC,CAAC,GACpD,IAAAoB,yCAAkB,EAAC,CAAC;AAC1B,CAAC;AAED,IAAMC,iBAA4C,GAAG;EACnDP,KAAK,EAALA,KAAK;EACLQ,cAAc,EAAEC,8CAAqB;EACrCC,QAAQ,EAAEJ;AACZ,CAAC;AAKM,IAAMK,YAAY,GAAG,SAAfA,YAAYA,CACvBC,IAAiB,EACjBC,UAAiC,EACjC3B,KAAuC;EAAA,OAEvC,IAAA4B,qBAAS,EAACP,iBAAiB,CAACK,IAAI,CAACG,IAAI,CAAC,EAAE;IAAA,OAAM,EAAE;EAAA,EAAC,CAACH,IAAI,EAAEC,UAAU,EAAE3B,KAAK,CAAC;AAAA;AAAA8B,OAAA,CAAAL,YAAA,GAAAA,YAAA"}